# 一、Install the required libraries

### Cmake

```
sudo apt-get install cmake
```

### Zeromq     

Two methods: The first one is to install using the git clone package.

gitclone command：

```
git clone https://github.com/zeromq/libzmq.git
```


The second method is to install directly using the following command.

```
apt-get install libzmq3-dev
```

### GMP

```
sudo apt install libgmp-dev
```

### RELIC

```cpp
git clone https://github.com/relic-toolkit/relic.git
cd relic
mkdir build
cd build
cmake .. -DARITH=gmp
make
```

Test

```cpp
make test
```

If all the tests are passed, then there will be no problem with the installation.

### PARI/GP

```cpp
wget https://pari.math.u-bordeaux.fr/pub/pari/unix/pari-2.17.2.tar.gz
tar zxvf pari-2.17.2.tar.gz
cd pari-2.17.2.tar.gz
./Configure
sudo make install

gp --version
```



# 二、Compile



After successfully installing all the libraries mentioned above, execute the following command in the /ecdsa folder of the code:



```
mkdir build
cd build
cmake..
make
```

# 三、Preparations before operation

```bash
#Config/blockchain/consortium_blockchain

geth --identity "myethereum" --dev --rpc --rpcaddr "127.0.0.1" --port 30304 --rpcport "7545" --rpccorsdomain "*" --datadir ./myblockchain --rpcapi "eth,net,web3,admin,personal" --networkid 5777 console --allow-insecure-unlock

#Config/blockchain/consortium_blockchain/myblockchain
geth attach geth.ipc

#Start mining
miner.start()

##Config/truffleProject/truffletest: Deploy the smart contract

truffle migrate --reset
npx truffle networks | cat

#Tiger-Mixer/Tiger-Mixer-master/ecdsa/bin：Unlock the account and transfer funds from account 0
./setup.sh 

#Config/truffleProject/truffletest/scripts:
truffle exec ./setup_candidate_pool.js Pre-assign committee members

```

# 四、Run

```bash
#/Agent
python3 service3.py

#/Tiger-Mixer/Tiger-Mixer-master/ecdsa/bin
#1、Enable automatic rotation of committee logs and output log files to /Tiger-Mixer/Tiger-Mixer-master/ecdsa/logs/auto_rotation_simple.log
./auto_rotation_simple.sh

#2、Incorporate committee members
./start_secret_share_receiver.sh

./tumbler 
./alice 8182 8183 0x9339c1e45f56ecf3af4ee2d976f31a12086ad506 0.1 8181
./bob 8183 8182 0x27766bfd44afdc46584e0550765181422c3ba080 8181
```

# Code Introduction

#### Coin mixing-related and script files：

- /Tiger-Mixer/Tiger-Mixer-master/ecdsa/src：It contains all the C files, including alice.c, bob.c, tumbler.c, auditor.c, secret_share_receiver.c and other files. The main mixing logic is executed here.

- /Tiger-Mixer/Tiger-Mixer-master/ecdsa/build：The directories for CMake and Make operations. The generated executable files are saved in the "bin" directory.

- /Tiger-Mixer/Tiger-Mixer-master/ecdsa/bin：Executable file save directory.

  

#### ETH Blockchain Related:

- `/Config/blockchain`: Files related to creating a private chain with geth
- `/Config/blockchain/consortium_blockchain`: Path for the private chain; commands to start the private chain are executed here
- `/Config/truffleProject`: Files related to interacting with geth, creating smart contracts, and deploying them on-chain
- `/Config/truffleProject/truffletest`: Currently used folder; all smart contracts related to this project are contained here

# Experiment Execution
## Performance Evaluation
**auditor_benchmark.csv**

`figc` is used to measure the work performed by the auditor: VSS verification, reconstructing transaction information, and reconstructing private keys.

The `auditor_benchmark.csv` is generated by **threshold_benchmark.c**

**dkg_threshold_benchmark.csv**

Generated file: `/Tiger-mixer/Tiger-mixer-master/ecdsa/src/dkg_threshold_benchmark.c`

Execution: `./dkg_threshold_benchmark.c` (run in `Tiger-Mixer/Tiger-Mixer-master/ecdsa/bin` directory)

Function: Tests the performance of DKG (Distributed Key Generation)

Main tasks:

- Uses Class Group commitment (2048-bit discriminant)
- Tests different committee sizes (3–20) and majority thresholds ((n+1)/2)
- Measures performance of 4 stages:
  - `ShareTime`: Share generation (polynomial coefficient generation + share computation)
  - `CommitmentTime`: Commitment generation (Class Group exponentiation \( g_q^{a_{ij}} \))
  - `VerificationTime`: Share verification (verifying shares from other n-1 participants)
  - `AggregationTime`: Private key share aggregation (combine shares into full DKG private key)
- Each configuration is tested 100 times; average time and success rate are calculated

**secret_share_threshold_benchmark.csv**

Generated file: `/Tiger-Mixer/Tiger-Mixer-master/ecdsa/src/secret_share_threshold_benchmark.c`

Function: Tests the performance of secret sharing (VSS – Verifiable Secret Sharing)

Main tasks:

- Uses elliptic curve Feldman VSS
- Supports block processing (fixed message size 15,767 bytes)
- Tests different committee sizes (3–20) and majority thresholds ((n+1)/2)
- Measures performance of 2 stages:
  1. `ShareTime`: Share generation (generate polynomial coefficients and shares for each block)
  2. `CommitmentTime`: Commitment generation (generate VSS commitments)
- Each configuration is tested 100 times; average time and success rate are calculated

## Effectiveness Evaluation
See the README file in the `Effection` folder
