# 性能对比：A2L 系统 vs Tornado Cash

## 1. 实验设置

本文对 A2L 系统与 Tornado Cash 进行了性能对比实验。实验排除了区块链交互时间（交易上链确认时间），专注于测量密码学计算和本地处理的耗时，以公平对比两个系统的密码学性能。

## 2. 密码学操作耗时对比

### 2.1 Tornado Cash 密码学操作

Tornado Cash 的主要密码学耗时集中在取款（withdraw）操作中的零知识证明生成：

- **zkSNARK Proof 生成**：904.4 ms（receiver 取款时）
- **Pedersen Hash 生成**：54.8 ms
- **Merkle Tree 插入**：19.1 ms
- **zkSNARK 验证**：在链上执行，受区块链速度影响，本文不统计

**注**：zkSNARK 验证在智能合约中执行，其耗时受区块链网络状态影响，因此本文仅统计本地计算部分。

### 2.2 A2L 系统密码学操作

A2L 系统的主要耗时同样集中在零知识证明的生成与验证部分：

- **零知识证明生成**：约 186-238 ms（根据角色不同）
- **零知识证明验证**：约 141-190 ms（根据角色不同）
- **Pedersen Hash 操作**：包含在整体流程中

**关键差异**：A2L 系统使用 **Pedersen 零知识证明**（Pedersen zk），相比 Tornado Cash 使用的 zkSNARK，计算复杂度更低，因此耗时显著更短。

## 3. 完整交易流程耗时对比

### 3.1 Tornado Cash 交易耗时

- **Sender（存款）**：89.41 ms
  - 不包括交易上链确认时间
  - 主要包括 Pedersen Hash 生成和 Merkle Tree 插入操作

- **Receiver（取款）**：960 ms
  - 不包括交易上链确认时间
  - 主要包括 zkSNARK Proof 生成（904.4 ms）和其他密码学操作

### 3.2 A2L 系统交易耗时

A2L 系统采用三方架构（Sender、Receiver、Hub），各角色耗时如下：

- **Sender（Alice）**：556.93 ms
  - 包括：注册、令牌分享、谜题随机化、零知识证明生成与验证、ECDSA 签名等操作
  - 纯计算时间（排除区块链交互和保存时间）：554.11 ms

- **Receiver（Bob）**：506.89 ms
  - 包括：令牌分享、承诺处理、谜题随机化、零知识证明生成与验证等操作
  - 纯计算时间（排除检查时间）：507.87 ms

- **Hub（Tumbler）**：608.5 ms
  - 包括：谜题生成、综合零知识证明生成、零知识证明验证、Adaptor ECDSA 签名等操作
  - 纯计算时间（排除区块链交互和检查时间）：707.16 ms

**注**：所有耗时均排除了区块链交互时间（如交易上链确认）和网络等待时间，仅统计本地密码学计算耗时。

## 4. 性能分析

### 4.1 密码学操作效率

| 系统 | 主要零知识证明类型 | 证明生成耗时 | 证明验证耗时 |
|------|-------------------|-------------|-------------|
| Tornado Cash | zkSNARK | 904.4 ms | 链上执行（不统计） |
| A2L | Pedersen zk | 186-238 ms | 141-190 ms |

**结论**：A2L 系统使用的 Pedersen 零知识证明在计算效率上显著优于 Tornado Cash 的 zkSNARK，证明生成时间约为后者的 1/4 到 1/5。

### 4.2 整体交易流程对比

| 系统 | Sender 耗时 | Receiver 耗时 | 总耗时（单方视角） |
|------|------------|--------------|------------------|
| Tornado Cash | 89.41 ms | 960 ms | 1049.41 ms（单次交易） |
| A2L | 556.93 ms | 506.89 ms | 1063.82 ms（三方总和） |

**分析**：
1. **Tornado Cash**：Sender 操作简单（仅存款），耗时短；Receiver 操作复杂（需生成 zkSNARK 证明），耗时长。
2. **A2L**：三方角色耗时相对均衡，Sender 和 Receiver 耗时相近（约 500-560 ms），Hub 作为协调者承担额外计算（约 600-700 ms）。

### 4.3 架构差异带来的性能特征

**Tornado Cash（两方架构）**：
- 优势：Sender 操作简单，耗时极短（89.41 ms）
- 劣势：Receiver 需要生成复杂的 zkSNARK 证明，耗时较长（960 ms）
- 特点：非对称性能分布，取款操作是性能瓶颈

**A2L（三方架构）**：
- 优势：使用高效的 Pedersen 零知识证明，单次证明生成耗时短（约 200 ms 级别）
- 特点：性能分布相对均衡，三方角色耗时相近
- 额外开销：Hub 作为协调者需要执行额外的谜题生成和综合零知识证明生成，增加了约 200 ms 的计算开销

## 5. 总结

### 5.1 主要发现

1. **密码学效率**：A2L 系统采用的 Pedersen 零知识证明在计算效率上显著优于 Tornado Cash 的 zkSNARK，证明生成时间约为后者的 1/4 到 1/5。

2. **整体性能**：虽然 A2L 系统采用三方架构，总计算量略高于 Tornado Cash 的两方架构，但由于使用了更高效的零知识证明方案，三方角色的耗时相对均衡，且单次证明生成耗时显著更短。

3. **性能分布**：
   - Tornado Cash：非对称性能分布，Receiver 的 zkSNARK 证明生成是主要性能瓶颈
   - A2L：相对均衡的性能分布，三方角色耗时相近，Hub 作为协调者承担额外的协调开销

### 5.2 性能权衡

A2L 系统通过引入 Hub 角色和高效的 Pedersen 零知识证明，实现了：
- ✅ **更快的零知识证明生成**：单次证明生成耗时从 904.4 ms 降低到约 200 ms 级别
- ✅ **更均衡的性能分布**：避免了单点性能瓶颈
- ⚠️ **额外的协调开销**：Hub 角色增加了约 200 ms 的计算开销

总体而言，A2L 系统在保持整体性能竞争力的同时，通过更高效的密码学方案实现了更均衡的性能分布，避免了 Tornado Cash 中 Receiver 端的性能瓶颈问题。






